# Template file for 'vscodium'
pkgname=vscodium
_pkgname=VSCodium
version=1.107.18627
revision=1
archs="x86_64"
depends="fontconfig libXtst gtk+3 python3 cairo alsa-lib nss libgcc libnotify	 bash"
short_desc="Binary releases of VS Code without MS branding/telemetry/licensing."
maintainer="Eren Öztürk <erenozturkhde@gmail.com>"
license="MIT"
homepage="https://github.com/VSCodium/vscodium"
distfiles="
https://raw.githubusercontent.com/VSCodium/vscodium/refs/tags/${version}/src/stable/resources/linux/code.svg
https://github.com/VSCodium/vscodium/releases/download/${version}/${_pkgname}-linux-x64-${version}.tar.gz
"
checksum="
e622e6bdb70b0cfec57ad9df8717ea023b87e5e215003119b5a1a4d059fcd347
82a07175de96c359c85e8be2c60b2e222bcb5e7d4ba195cde4d84ae1b2e64a78
"
skip_extraction="code.svg"
shopt -s extglob

do_install(){
	vmkdir opt/${pkgname}
	vmkdir usr/bin
	vmkdir usr/share/applications
	vmkdir usr/share/pixmaps
	vinstall ${FILESDIR}/LICENSE 644 "/usr/share/licenses/${pkgname}/"
	vcopy $wrksrc/* opt/${pkgname}
	find "${DESTDIR}/opt/${pkgname}" -maxdepth 1 -type l -delete
	ln -sf "/opt/${pkgname}/bin/codium" "${DESTDIR}/usr/bin/codium"
	ln -sf "/opt/${pkgname}/bin/codium" "${DESTDIR}/usr/bin/vscodium"
	vinstall ${FILESDIR}/"vscodium.desktop" 644 "/usr/share/applications/"
	vinstall ${FILESDIR}/"vscodium-wayland.desktop" 644 "/usr/share/applications/"
	vinstall ${FILESDIR}/"vscodium-url-handler.desktop" 644 "/usr/share/applications/"
	vinstall "resources/app/resources/linux/code.png" 644 "/usr/share/pixmaps/" vscodium.png
	vinstall $XBPS_SRCDISTDIR/${pkgname}-${version}/"code.svg" 644 "/usr/share/icons/hicolor/scalable/apps/" vscodium.svg
	vinstall ${FILESDIR}/"${pkgname}.sh" 755 "/usr/bin/" codium
	vinstall $wrksrc/chrome-sandbox 4755 "/opt/${pkgname}/"
	vmkdir usr/share/zsh/site-functions
	vmkdir usr/share/bash-completion/completions
	ln -s "/opt/${pkgname}/resources/completions/zsh/_codium" "${DESTDIR}/usr/share/zsh/site-functions"
	ln -s "/opt/${pkgname}/resources/completions/bash/codium" "${DESTDIR}/usr/share/bash-completion/completions"

}

